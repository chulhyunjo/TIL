# 5. 관계 모델 참조

> Related manager

- Related manager는 N : 1 혹은 M : N 관계에서 사용 가능한 문맥(context)
- Django는 모델 간 N:1 혹은 M:N관계가 설정되면 **역참조**할 때에 사용할 수 있는 manager를 생성
  - 우리가 이전에 모델 생성시 objects라는 매니저를 통해 queryset api를 사용했던 것처럼 related manager를 통해 queryset api를 사용할 수 있게 된다.





> 역참조

- 나를 참조하는 테이블(나를 외래 키로 지정한)을 참조하는 것
- 즉, 본인을 외래 키로 참조 중인 다른 테이블에 접근하는 것
- N:1 관계에서는 1이 N을 참조하는 상황
  - 외래 키를 가지지 않은 1이 외래 키를 가진 N을 참조



```python
article.(comment)_set.method()
```

- Article 모델이 Comment 모델을 참조(역참조)할 때 사용하는 매니저
- article.comment 형식으로 댓글 객체를 참조 할 수 없음
  - 실제로 Article 클래스에는 Comment와의 어떠한 관계도 작성되어 있지 않다
- comment_set manager를 자동으로 생성해 article.comment_set 형태로 참조한다.
- 참조 상황(Comment -> Article)에서는 실제 ForeignKey 클래스로 작성한 인스턴스가 Comment 클래스의 클래스 변수이기 때문에 comment.article 형태로 작성 가능하다



```python
# article.comment_set.all(), 모든 댓글 출력하기
comments = article.comment_set.all()

for comment in comments:
    print(comment.content)
```



> ForeignKey arguments

1. related_name
   - Foreignkey 클래스의 선택 옵션
   - 역참조 시 사용하는 매니저 이름(model_set manager)을 변경할 수 있음
   - 작성 후, migration 과정이 필요
   - 선택 옵션이다.

```python
# articles/models.py
article = models.ForeignKey(Article, on_delete=models.CASCADE, related_name='comments')
```



Admin site에 등록

\# articles/admin.py